<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Splout SQL</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/bootstrap-responsive.min.css" rel="stylesheet">
	
	<!-- Modified asciidoc css -->
	<link rel="stylesheet" href="./css/xhtml11.css" type="text/css" />
	<link rel="stylesheet" href="./css/xhtml11-quirks.css" type="text/css" />
	
    <style>

    /* GLOBAL STYLES
    -------------------------------------------------- */
    /* Padding below the footer and lighter body text */
	
	p, h1, h2, h3, h4, h5 {
	  padding-bottom: 5px; /* general breathing for everything */
	}
	
    body {
      padding-bottom: 40px;
      color: #5a5a5a;
    }

	dt {
	  padding-bottom: 5px;
	  font-size:20px;
	}
	
	dl {
	 padding-bottom: 15px;
	}

    /* Carousel base class */
    .carousel {
      margin-bottom: 60px;
    }

    .carousel .container {
      position: absolute;
      right: 0;
      bottom: 0;
      left: 0;
    }

    .carousel-control {
      background-color: transparent;
      border: 0;
      font-size: 120px;
      margin-top: 0;
      text-shadow: 0 1px 1px rgba(0,0,0,.4);
    }

    .carousel .item {
      height: 250px;
    }
    .carousel img {
      min-width: 100%;
      height: 250px;
    }

    .carousel-caption {
      background-color: transparent;
      position: static;
      max-width: 550px;
      padding: 0 20px;
      margin-bottom: 100px;
    }
    .carousel-caption h1,
    .carousel-caption .lead {
      margin: 0;
      line-height: 1.25;
      color: #fff;
      text-shadow: 0 1px 1px rgba(0,0,0,.4);
    }
    .carousel-caption .btn {
      margin-top: 10px;
    }

    /* RESPONSIVE CSS
    -------------------------------------------------- */

    @media (max-width: 979px) {
      .container.navbar-wrapper {
        margin-bottom: 0;
        width: auto;
      }
      .navbar-inner {
        border-radius: 0;
        margin: -20px 0;
      }

      .carousel .item {
        height: 300px;
      }
      .carousel img {
        width: auto;
        height: 300px;
      }
    }

    @media (max-width: 767px) {
      .navbar-inner {
        margin: -20px;
      }
      .carousel {
        margin-left: -20px;
        margin-right: -20px;
      }
      .carousel .container {
      }
      .carousel .item {
        height: 300px;
      }
      .carousel img {
        height: 300px;
      }
      .carousel-caption {
        width: 65%;
        padding: 0 70px;
        margin-bottom: 40px;
      }
      .carousel-caption h1 {
        font-size: 30px;
      }
      .carousel-caption .lead,
      .carousel-caption .btn {
        font-size: 18px;
      }
    }
    </style>
  </head>

<body style="padding-top: 50px;">
  
<div class="container">

 <div class="navbar navbar-fixed-top">
   <div class="navbar-inner">
     <div class="container">
        <a class="brand" href="index.html">Splout SQL</a>
        <div class="nav-collapse">
          <ul class="nav">
            <li><a href="features.html">Features</a></li>
            <li><a href="philosophy.html">Philosophy</a></li>
            <li><a href="architecture.html">Architecture</a></li>
            <li><a href="gettingstarted.html">Getting started</a></li>
            <li class="dropdown"><a href="user_guide.html">User guide</a>
            </li>
            <li><a href="#">F.A.Q.</a></li>
          </ul>
          <ul class="nav pull-right">
            <li class="divider-vertical"></li>
            <li class="dropdown">
              <a href="#">About</a>
            </li>
          </ul>
        </div><!-- /.nav-collapse -->
     </div>
   </div>
 </div><!-- /navbar -->

<div class="page-header">
  <h2 style="align:center;">Splout's architecture</h2>
</div>

<p>Splout SQL is a read-only DB. Because of this, the overall architecture is quite simple.</p>

<ul>
	<li>Splout SQL is installed on a cluster of commodity hardware machines. Each of the machines runs a <strong>DNode</strong> service and optionally a <strong>QNode</strong> service (<em>but there must be at least one QNode service among the cluster</em>).</li>
	<li>QNodes implement a <strong>REST API</strong> for serving users' queries or receiving deploy / rollback requests.</li>
	<li>Because <strong>data is partitioned</strong>, QNodes talk to the appropriate DNode for serving a query and the DNode responds back with the query’s result.</li>
	<li>A <strong>Hadoop cluster</strong> is used for indexing and balancing the data. The resultant SQL files are fetched by the DNodes by handling a data deploy request.</li>
</ul>

<center><img src='img/Splout_SQL.jpg'></center>

<h2>Data balancing & indexing</h2>

<p>Arbitrarily big datasets are handled by Splout by using a Hadoop batch process that partitions and indexes the data according to a users' partitioning policy.</p>

<ul>
<li>Usually this involves partitioning by one or more columns in a columnar dataset, for example <strong>customer_id</strong>. But you can also partition by an arbitrary Java or JavaScript function, for instance.</li>
<li>Splout uses <strong>sampling methods</strong> for deciding how to split the dataset after applying users’ partitioning function.</li>
<li>A simple method (a-la-<a href='http://hadoop.apache.org/docs/current/api/org/apache/hadoop/examples/terasort/package-summary.html' target='_blank'>Hadoop's TeraSort</a>) is the default one, but a more sophisticated one - althought more computationally expensive - (<a href='http://en.wikipedia.org/wiki/Reservoir_sampling'>Reservoir Sampling</a>) can be used in datasets where the default one is not enough.</li>
<li>The DNodes fetch new data on a deploy request. The data is downloaded, <strong>atomically replaced and versioned</strong>. The cluster coordinates itself for assuring version consistency and no downtime while deploying. The user can choose to <strong>rollback</strong> to previous versions anytime, and the operation will be as quick as a "mv" between folders.</li>
</ul>

<h2>Technology choices</h2>

<ul>

<li>QNodes, DNodes are implemented as <strong>Java</strong> services serving queries through a <a href='http://jersey.java.net/' target='_blank'>Jersey</a> REST interface.</li>
<li>Splout SQL cluster handles membership and coordinates deployments and rollbacks through <a href='http://jersey.java.net/' target='_blank'>Hazelcast</a>.</li>
<li>Splout uses <a href='http://pangool.net' target='_blank'>Pangool</a> for low-level Java Hadoop development. In this way, the code for data store generation is pretty simple and performant at the same time.</li>
<li>Splout generates <a href='http://www.sqlite.org/' target='_blank'>SQLite</a> files that are used by DNodes for serving data.</li>

</ul>

<br><br><br><br>
      <!-- Footer -->
      <footer class="footer">
        <p class="pull-right"><a href="#">Splout is maintained by Datasalt</a></p>
      </footer>
</div><!-- /container -->
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/bootswatch.js"></script>
  </body>
</html>